<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>1A2B çŒœæ•¸å­—éŠæˆ²</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans TC", Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-4 md:p-8">
  <div class="max-w-2xl mx-auto">
    <header class="text-center mb-8">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-3">ğŸ¯ 1A2B çŒœæ•¸å­—</h1>
      <p class="text-gray-600 text-base md:text-lg leading-relaxed">é›»è…¦æœƒç”¢ç”Ÿä¸€çµ„ã€Œ4 ä½ä¸é‡è¤‡æ•¸å­—ï¼ˆé¦–ä½ä¸ç‚º 0ï¼‰ã€çš„è¬åº•ã€‚<br>æ•¸å­—æ­£ç¢ºä¸”ä½ç½®æ­£ç¢ºç®— <span class="font-bold text-green-600">A</span>ï¼›æ•¸å­—æ­£ç¢ºä½†ä½ç½®éŒ¯èª¤ç®— <span class="font-bold text-orange-600">B</span>ã€‚</p>
    </header>

    <section class="bg-white rounded-2xl shadow-xl p-6 md:p-8 border border-gray-200">
      <div class="space-y-4">
        <input id="guess" type="text" inputmode="numeric" maxlength="4"
               class="w-full border-2 border-gray-300 rounded-xl px-4 py-4 md:py-5 text-2xl md:text-3xl mono text-center font-bold focus:border-blue-500 focus:ring-4 focus:ring-blue-200 transition"
               placeholder="è¼¸å…¥ 4 ä½æ•¸å­—" />
        
        <div class="grid grid-cols-2 gap-3">
          <button id="submit" class="w-full px-6 py-4 md:py-5 text-lg md:text-xl rounded-xl bg-blue-600 text-white font-bold hover:bg-blue-700 active:scale-95 transition shadow-lg hover:shadow-xl">
            ğŸš€ é€å‡ºçŒœæ¸¬
          </button>
          <button id="restart" class="w-full px-6 py-4 md:py-5 text-lg md:text-xl rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold hover:from-purple-600 hover:to-pink-600 active:scale-95 transition shadow-lg hover:shadow-xl">
            ğŸ”„ é‡æ–°é–‹å§‹
          </button>
        </div>
      </div>
      
      <p id="tip" class="text-sm md:text-base text-gray-500 mt-4 text-center">ğŸ’¡ æç¤ºï¼šä¸å¯é‡è¤‡ã€é¦–ä½ä¸å¯ç‚º 0ã€‚å¯æŒ‰ Enter é€å‡ºã€‚</p>

      <div id="result" class="mt-6 hidden p-4 md:p-5 rounded-xl bg-gradient-to-r from-green-50 to-emerald-50 text-green-700 border-2 border-green-300 text-center font-bold text-lg md:text-xl shadow-inner"></div>

      <div class="mt-8">
        <h2 class="mb-4 font-bold text-gray-800 text-xl md:text-2xl flex items-center gap-2">
          <span>ğŸ“</span>
          <span>çŒœæ¸¬ç´€éŒ„</span>
        </h2>
        <div id="history" class="space-y-3 max-h-96 overflow-y-auto"></div>
      </div>
    </section>

    <div class="text-center mt-8">
      <a href="index.html" class="inline-flex items-center gap-2 px-6 py-3 text-base md:text-lg text-blue-600 hover:text-blue-700 font-semibold hover:underline transition">
        <span>â†</span>
        <span>å›åˆ°å­¸ç¿’ä¸­å¿ƒ</span>
      </a>
    </div>
  </div>

  <script>
    (function(){
      const $ = (id) => document.getElementById(id);
      const guessInput = $('guess');
      const submitBtn = $('submit');
      const restartBtn = $('restart');
      const historyBox = $('history');
      const resultBox = $('result');

      let answer = '';
      let round = 0;

      function genAnswer(){
        // 4 ä½æ•¸ï¼Œé¦–ä½ä¸å¯ç‚º 0ã€å››ä½ä¸é‡è¤‡
        const digits = ['0','1','2','3','4','5','6','7','8','9'];
        // é¦–ä½ï¼š1-9
        const first = String(Math.floor(Math.random()*9) + 1);
        const remain = digits.filter(d => d !== first);
        // æ¥ä¸‹ä¾†å¾ remain æŠ½ 3 å€‹ä¸é‡è¤‡
        for(let i=remain.length-1;i>0;i--){
          const j = Math.floor(Math.random()*(i+1));
          [remain[i], remain[j]] = [remain[j], remain[i]];
        }
        answer = first + remain.slice(0,3).join('');
        round = 0;
        historyBox.innerHTML = '';
        resultBox.classList.add('hidden');
        resultBox.textContent = '';
      }

      function isValidGuess(s){
        if(!/^\d{4}$/.test(s)) return false;
        if(s[0] === '0') return false;
        // ä¸é‡è¤‡
        return new Set(s.split('')).size === 4;
      }

      function judge(guess, target){
        let A = 0, B = 0;
        for(let i=0;i<4;i++){
          if(guess[i] === target[i]) A++;
          else if(target.includes(guess[i])) B++;
        }
        return { A, B };
      }

      function addHistoryRow(guess, A, B){
        const div = document.createElement('div');
        div.className = 'flex items-center justify-between bg-gradient-to-r from-gray-50 to-gray-100 border-2 border-gray-200 rounded-xl px-4 md:px-5 py-3 md:py-4 hover:shadow-md transition';
        div.innerHTML = `
          <span class="mono text-lg md:text-xl font-bold text-gray-700">#${String(++round).padStart(2,'0')}  ${guess}</span>
          <span class="font-bold text-xl md:text-2xl ${A===4? 'text-green-600 animate-pulse':'text-gray-800'}">${A}A${B}B</span>
        `;
        historyBox.prepend(div);
      }

      function onSubmit(){
        const g = guessInput.value.trim();
        if(!isValidGuess(g)){
          guessInput.classList.add('ring-4','ring-red-400','border-red-400');
          $('tip').textContent = 'âŒ è«‹è¼¸å…¥æœ‰æ•ˆçš„ 4 ä½ä¸é‡è¤‡æ•¸å­—ï¼Œä¸”é¦–ä½ä¸å¯ç‚º 0ã€‚';
          $('tip').classList.add('text-red-600');
          return;
        }
        guessInput.classList.remove('ring-4','ring-red-400','border-red-400');
        $('tip').textContent = 'ğŸ’¡ æç¤ºï¼šä¸å¯é‡è¤‡ã€é¦–ä½ä¸å¯ç‚º 0ã€‚å¯æŒ‰ Enter é€å‡ºã€‚';
        $('tip').classList.remove('text-red-600');

        const {A,B} = judge(g, answer);
        addHistoryRow(g, A, B);
        guessInput.value = '';
        guessInput.focus();

        if(A === 4){
          resultBox.textContent = `ğŸ‰ æ­å–œç­”å°ï¼ç­”æ¡ˆæ˜¯ ${answer}ã€‚å…±çŒœäº† ${round} æ¬¡ï¼`;
          resultBox.classList.remove('hidden');
        }
      }

      submitBtn.addEventListener('click', onSubmit);
      guessInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') onSubmit(); });
      restartBtn.addEventListener('click', genAnswer);

      // åˆå§‹åŒ–
      genAnswer();
    })();
  </script>
</body>
</html>
