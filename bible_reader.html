<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è–ç¶“é‡‘å¥è®€ç¨¿æ©Ÿ (ä½¿å¾’è¡Œå‚³ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: #f3f4f6;
            padding-bottom: 120px; /* Space for fixed footer */
        }
        .verse-item {
            transition: all 0.3s ease;
        }
        .verse-item.active {
            background-color: #dbeafe; /* Blue-100 */
            border-left: 5px solid #2563eb; /* Blue-600 */
            transform: scale(1.02);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .verse-text {
            line-height: 1.6;
        }
        /* Custom scrollbar for better UX */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #888; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555; 
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-10">
        <div class="max-w-4xl mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-gray-800">ğŸ“– è–ç¶“é‡‘å¥è®€ç¨¿æ©Ÿ <span class="text-sm font-normal text-gray-500 ml-2">(ä½¿å¾’è¡Œå‚³ç¯‡)</span></h1>
            <div class="text-sm text-gray-500">Hector's Dev</div>
        </div>
    </header>

    <!-- Controls & Settings Area -->
    <div class="max-w-4xl mx-auto px-4 py-4">
        <div class="bg-white rounded-lg shadow p-4 mb-4">
            <div class="flex flex-wrap gap-4 items-center justify-between">
                
                <!-- Selection Tools -->
                <div class="space-x-2">
                    <button onclick="selectAll(true)" class="px-3 py-1 text-sm border rounded hover:bg-gray-50 text-gray-600">å…¨é¸</button>
                    <button onclick="selectAll(false)" class="px-3 py-1 text-sm border rounded hover:bg-gray-50 text-gray-600">å…¨å–æ¶ˆ</button>
                </div>

                <!-- Speed Control -->
                <div class="flex items-center gap-2">
                    <label for="rate" class="text-sm text-gray-600">èªé€Ÿ:</label>
                    <input type="range" id="rate" min="0.5" max="2" value="1" step="0.1" class="w-24 accent-blue-600" oninput="updateRateLabel(this.value)">
                    <span id="rateLabel" class="text-sm font-mono w-8">1.0</span>
                </div>

                <!-- Loop Toggle -->
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="loopToggle" class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500">
                    <label for="loopToggle" class="text-sm text-gray-700 cursor-pointer select-none">å¾ªç’°æ’­æ”¾åˆ—è¡¨</label>
                </div>
            </div>
        </div>

        <!-- Verses List -->
        <div id="verseList" class="space-y-3">
            <!-- JavaScript will populate this -->
            <div class="text-center py-10 text-gray-500">è¼‰å…¥ä¸­...</div>
        </div>
    </div>

    <!-- Fixed Footer Controls -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] z-20">
        <div class="max-w-4xl mx-auto px-4 py-3 flex items-center justify-between">
            <div class="text-sm text-gray-500 hidden sm:block" id="statusText">æº–å‚™å°±ç·’</div>
            
            <div class="flex gap-4 mx-auto sm:mx-0">
                <button onclick="stopReading()" class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 transition" title="åœæ­¢">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z" />
                    </svg>
                </button>
                
                <button id="playBtn" onclick="startReading()" class="flex items-center justify-center w-14 h-14 rounded-full bg-blue-600 text-white hover:bg-blue-700 shadow-lg transition transform hover:scale-105" title="é–‹å§‹æœ—è®€">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Data: 40 Bible Verses (User Provided - Mostly Acts)
        const bibleVerses = [
            { ref: "ä½¿å¾’è¡Œå‚³ 1:8", text: "ä½†è–éˆé™è‡¨åœ¨ä½ å€‘èº«ä¸Šï¼Œä½ å€‘å°±å¿…å¾—ç€èƒ½åŠ›ï¼Œä¸¦è¦åœ¨è€¶è·¯æ’’å†·ã€çŒ¶å¤ªå…¨åœ°å’Œæ’’é¦¬åˆ©äºï¼Œç›´åˆ°åœ°æ¥µï¼Œä½œæˆ‘çš„è¦‹è­‰ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 1:14", text: "ä»–å€‘éƒ½åŒå¿ƒåˆæ„åœ°æ†åˆ‡ç¦±å‘Šï¼Œé‚„æœ‰å¹¾å€‹å©¦å¥³å’Œè€¶ç©Œçš„æ¯è¦ªé¦¬åˆ©äºï¼Œä»¥åŠè€¶ç©Œçš„å¼Ÿå…„ï¼Œéƒ½åœ¨ä¸€èµ·ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 2:4", text: "ä»–å€‘éƒ½è¢«è–éˆå……æ»¿ï¼Œç…§è‘—è–éˆæ‰€è³œçš„èƒ½åŠ›ï¼Œèªªèµ·åˆ¥åœ‹çš„è©±ä¾†ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 2:38", text: "ã€Œä½ å€‘å„äººè¦æ‚”æ”¹ï¼Œå¥‰è€¶ç©ŒåŸºç£çš„åå—æ´—ï¼Œä½¿ä½ å€‘çš„ç½ªå¾—èµ¦ï¼Œå°±å¿…é ˜å—æ‰€è³œçš„è–éˆã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 2:42", text: "ä»–å€‘éƒ½å°ˆå¿ƒè‡´åŠ›æ–¼ä½¿å¾’çš„æ•™å°ã€å½¼æ­¤çš„äº¤æ¥ã€æ“˜é¤…å’Œç¥ˆç¦±ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 3:6", text: "ã€Œé‡‘éŠ€æˆ‘éƒ½æ²’æœ‰ï¼Œä½†æˆ‘æŠŠæˆ‘æ‰€æœ‰çš„çµ¦ä½ ï¼šå¥‰æ‹¿æ’’å‹’äººè€¶ç©ŒåŸºç£çš„åèµ·ä¾†èµ°è·¯ï¼ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 4:12", text: "é™¤äº†ä»–ä»¥å¤–ï¼Œåˆ¥ç„¡æ‹¯æ•‘ï¼›å› ç‚ºåœ¨å¤©ä¸‹äººé–“ï¼Œæ²’æœ‰è³œä¸‹åˆ¥çš„åï¼Œæˆ‘å€‘å¯ä»¥é è‘—å¾—æ•‘ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 4:32", text: "é‚£è¨±å¤šä¿¡çš„äººéƒ½æ˜¯ä¸€å¿ƒä¸€æ„çš„ï¼Œæ²’æœ‰ä¸€äººèªªä»–çš„æ±è¥¿æœ‰ä¸€æ¨£æ˜¯è‡ªå·±çš„ï¼Œéƒ½æ˜¯å¤§å®¶å…¬ç”¨ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 5:29", text: "ã€Œé †å¾ç¥ï¼Œä¸é †å¾äººï¼Œæ˜¯æ‡‰ç•¶çš„ã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 6:3", text: "æ‰€ä»¥å¼Ÿå…„å€‘ï¼Œå¾ä½ å€‘ä¸­é–“æ€é¸ä¸ƒå€‹æœ‰å¥½åè²ã€è¢«è–éˆå……æ»¿åˆæœ‰æ™ºæ…§çš„äººï¼Œæˆ‘å€‘å°±å§”æ´¾ä»–å€‘ç®¡ç†é€™äº‹ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 7:56", text: "ã€Œçœ‹å“ªï¼Œæˆ‘çœ‹è¦‹å¤©é–‹äº†ï¼Œäººå­ç«™åœ¨ç¥çš„å³é‚Šã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 8:6", text: "çœ¾äººéƒ½å°ˆå¿ƒè½è…“åˆ©æ‰€èªªçš„è©±ï¼Œå› ç‚ºè½è¦‹äº†ï¼Œåˆçœ‹è¦‹ä»–æ‰€è¡Œçš„ç¥è¹Ÿã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 8:36", text: "â€¦ã€Œçœ‹å“ªï¼Œé€™è£¡æœ‰æ°´ï¼Œæœ‰ä»€éº¼å¯ä»¥é˜»æ­¢æˆ‘å—æ´—å‘¢ï¼Ÿã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 9:5", text: "ä»–èªªï¼šã€Œä¸»å•Šï¼Œä½ æ˜¯èª°ï¼Ÿã€ä¸»èªªï¼šã€Œæˆ‘å°±æ˜¯ä½ æ‰€è¿«å®³çš„è€¶ç©Œã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 9:34", text: "å½¼å¾—å°ä»–èªªï¼šã€Œä»¥å°¼é›…ï¼Œè€¶ç©ŒåŸºç£é†«å¥½ä½ äº†ï¼èµ·ä¾†ï¼Œæ”¶å¥½ä½ çš„è¤¥å­ï¼ã€ä»–å°±ç«‹åˆ»èµ·ä¾†ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 10:34-35", text: "...ã€Œæˆ‘ç¾åœ¨çœŸæ˜ç™½ï¼Œç¥æ˜¯ä¸åå¾…äººçš„ã€‚åŸä¾†ï¼Œå„åœ‹ä¸­æ•¬ç•ä»–ã€è¡Œç¾©çš„äººï¼Œéƒ½è’™ä»–æ‚…ç´ã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 11:26", text: "é–€å¾’è¢«ç¨±ç‚ºã€ŒåŸºç£å¾’ã€ï¼Œæ˜¯å¾å®‰æé˜¿é–‹å§‹çš„ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 12:7", text: "å¿½ç„¶ï¼Œä¸»çš„ä¸€ä½ä½¿è€…ä¾†åˆ°ï¼Œå±‹å­è£¡æœ‰å…‰ç…§è€€ã€‚å¤©ä½¿æ‹å½¼å¾—çš„è‚‹æ—ï¼ŒæŠŠä»–å«é†’ï¼Œèªªï¼šã€Œå¿«å¿«èµ·ä¾†ï¼ã€éµéŠå°±å¾ä»–çš„æ‰‹ä¸Šè„«è½äº†ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 13:2-3", text: "è–éˆèªªï¼šã€Œè¦ç‚ºæˆ‘åˆ†æ´¾å·´æ‹¿å·´å’Œæƒç¾…ï¼Œå»ä½œæˆ‘å¬ä»–å€‘æ‰€ä½œçš„å·¥ã€‚ã€æ–¼æ˜¯ç¦é£Ÿç¦±å‘Šï¼ŒæŒ‰æ‰‹åœ¨ä»–å€‘èº«ä¸Šï¼Œå°±æ‰“ç™¼ä»–å€‘å»äº†ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 14:15", text: "ã€Œæˆ‘å€‘ä¹Ÿæ˜¯äººï¼Œæ€§æƒ…å’Œä½ å€‘ä¸€æ¨£ã€‚æˆ‘å€‘å‚³å¥½æ¶ˆæ¯çµ¦ä½ å€‘ï¼Œæ˜¯è¦ä½ å€‘é›¢é–‹é€™äº›è™›å¦„çš„äº‹ï¼Œæ­¸å‘é‚£å‰µé€ å¤©åœ°æµ·å’Œå…¶ä¸­è¬ç‰©çš„æ°¸ç”Ÿç¥ã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 15:11", text: "ã€Œ...æˆ‘å€‘ç›¸ä¿¡ï¼Œæˆ‘å€‘å¾—æ•‘æ˜¯å› ä¸»è€¶ç©Œçš„æ©å…¸ï¼Œå’Œä»–å€‘ä¸€æ¨£ã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 16:25", text: "ç´„åœ¨åŠå¤œï¼Œä¿ç¾…å’Œè¥¿æ‹‰ç¦±å‘Šï¼Œå”±è©©è®šç¾ç¥ï¼Œçœ¾å›šçŠ¯éƒ½å´è€³è½ä»–å€‘ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 17:24", text: "å‰µé€ å®‡å®™å’Œå…¶ä¸­è¬ç‰©çš„ä¸Šå¸ï¼Œæ—¢æ˜¯å¤©åœ°çš„ä¸»ï¼Œå°±ä¸ä½äººæ‰‹æ‰€é€ çš„æ®¿ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 20:24", text: "æˆ‘å»ä¸ä»¥æ€§å‘½ç‚ºå¿µï¼Œä¹Ÿä¸çœ‹ç‚ºå¯¶è²´ï¼Œåªè¦è¡Œå®Œæˆ‘çš„è·¯ç¨‹ï¼Œå®Œæˆå¾ä¸»è€¶ç©Œæ‰€é ˜å—çš„è·äº‹ï¼Œè¦è­‰æ˜ç¥æ©æƒ çš„ç¦éŸ³ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 26:29", text: "ä¿ç¾…èªªï¼šã€Œæˆ‘æ±‚ç¥ï¼Œä¸ä½†ä½ ä¸€å€‹äººï¼Œç”šè‡³ä»Šå¤©ä¸€åˆ‡è½æˆ‘èªªè©±çš„äººï¼Œéƒ½è¦åƒæˆ‘ä¸€æ¨£ï¼Œåªæ˜¯ä¸è¦åƒæˆ‘æœ‰é€™äº›é–éŠã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 28:31", text: "ä»–å…¨ç„¶å‚³è¬›ç¥çš„åœ‹ï¼Œä¸¦æ•™å°ä¸»è€¶ç©ŒåŸºç£çš„äº‹ï¼Œæ¯«ç„¡é˜»ç¤™ï¼Œæ”¾è†½è¬›è«–ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 18:9-11", text: "æœ‰ä¸€å€‹æ™šä¸Šï¼Œä¿ç¾…å¾—äº†ä¸€å€‹ç•°è±¡ã€‚ä¸»åœ¨ç•°è±¡ä¸­å°ä»–èªªï¼šã€Œä½ åˆ¥å®³æ€•ï¼Œåªç®¡è¬›ï¼Œä¸è¦ç·˜é»˜ï¼Œæœ‰æˆ‘èˆ‡ä½ åŒåœ¨ï¼Œæ²’æœ‰äººèƒ½å‚·å®³ä½ ï¼Œè€Œä¸”é€™åŸè£¡æœ‰è¨±å¤šæˆ‘çš„å­æ°‘ã€‚ã€ä¿ç¾…å°±åœ¨é‚£è£¡ä½äº†ä¸€å¹´åŠï¼ŒæŠŠä¸Šå¸çš„é“æ•™å°ä»–å€‘ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 19:8-12", text: "ä¸€é€£ä¸‰å€‹æœˆï¼Œä¿ç¾…ç…§å¸¸åˆ°æœƒå ‚å»ï¼Œå¤§è†½åœ°è¬›é“ï¼Œè·Ÿäººå®¶è¾¯è«–ä¸Šå¸åœ‹çš„äº‹ï¼Œå‹¸äººæ­¸ä¿¡ã€‚ä»–å€‘ç•¶ä¸­æœ‰äº›äººé ‘å›ºä¸è‚¯ç›¸ä¿¡ï¼›åœ¨æœƒçœ¾é¢å‰å…¬ç„¶æ¯€è¬—ä¸»çš„é“è·¯ã€‚æ–¼æ˜¯ä¿ç¾…å¸¶è‘—é–€å¾’é›¢é–‹ä»–å€‘ï¼Œå¤©å¤©åœ¨æ¨å–‡å¥´è¬›å ‚é€²è¡Œè¨è«–ã€‚é€™æ¨£çš„å·¥ä½œç¹¼çºŒäº†å…©å¹´ï¼Œå› æ­¤æ‰€æœ‰ä½åœ¨äºç´°äºçœçš„äººï¼Œç„¡è«–çŒ¶å¤ªäººæˆ–å¤–é‚¦äººï¼Œéƒ½è½è¦‹ä¸»çš„é“ã€‚ä¸Šå¸è—‰è‘—ä¿ç¾…è¡Œäº†äº›å¥‡ç•°çš„ç¥è¹Ÿï¼›ç”šè‡³æœ‰äººæŠŠä»–ç”¨éçš„æ‰‹å·¾æˆ–åœè£™æ‹¿å»æ”¾åœ¨ç—…äººèº«ä¸Šï¼Œç–¾ç—…å°±æ¶ˆé™¤äº†ï¼Œé‚ªéˆä¹Ÿå¾é™„è‘—çš„äººèº«ä¸Šå‡ºä¾†ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 19:18-20", text: "æœ‰è¨±å¤šä¿¡å¾’é–‹å§‹æŠŠä»–å€‘ä»¥å¾€æ‰€åšéçš„äº‹å…¬é–‹å¦ç™½åœ°æ‰¿èªå‡ºä¾†ã€‚è¨±å¤šè¡Œé‚ªè¡“çš„äººå¸¶ä¾†ä»–å€‘çš„æ›¸ï¼Œå †åœ¨ä¸€èµ·ï¼Œç•¶çœ¾ç„šç‡’ã€‚ä»–å€‘è¨ˆç®—é€™äº›æ›¸çš„åƒ¹éŒ¢ï¼Œç¸½å…±ç´„å€¼äº”è¬éŠ€å¹£ã€‚é€™æ¨£ï¼Œä¸»çš„é“æ™®éå‚³é–‹ï¼Œå¤§å¤§èˆˆæ—ºã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 20:22-24", text: "ç¾åœ¨ï¼Œç‚ºè‘—é †æœè–éˆï¼Œæˆ‘è¦ä¸Šè€¶è·¯æ’’å†·å»ã€‚æˆ‘ä¸çŸ¥é“åœ¨é‚£è£¡è¦é‡åˆ°ä»€éº¼äº‹ï¼›æˆ‘åªçŸ¥é“ï¼Œåœ¨å„åŸå¸‚è–éˆéƒ½æŒ‡ç¤ºæˆ‘ï¼Œæœ‰ç›£ç„å’Œç½é›£ç­‰è‘—æˆ‘ã€‚ä½†æ˜¯ï¼Œæˆ‘ä¸¦ä¸çæƒœè‡ªå·±çš„æ€§å‘½ï¼Œç‚ºçš„æ˜¯è¦å®Œæˆæˆ‘çš„ä½¿å‘½ï¼Œæˆå°±ä¸»è€¶ç©Œäº¤çµ¦æˆ‘çš„å·¥ä½œï¼Œå°±æ˜¯è¦‹è­‰ä¸Šå¸æ©å…¸çš„ç¦éŸ³ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 20:28-31", text: "ä½ å€‘è‡ªå·±è¦è¬¹æ…ï¼Œä¹Ÿè¦ç‚ºè–éˆæ‰€ä»˜è¨—ä½ å€‘ç…§é¡§çš„å…¨ç¾¤è¬¹æ…ã€‚è¦ç‰§é¤Šä¸Šå¸çš„æ•™æœƒâ€”å°±æ˜¯ä»–è—‰è‘—è‡ªå·±å…’å­çš„æ­»æ‰€æ›ä¾†çš„ã€‚æˆ‘çŸ¥é“åœ¨æˆ‘é›¢é–‹å¾Œï¼Œæœ‰å‡¶æš´çš„è±ºç‹¼è¦æ··å…¥ä½ å€‘ä¸­é–“ä¾†å‚·å®³ç¾Šç¾¤ã€‚å°±æ˜¯åœ¨ä½ å€‘ä¸­é–“ï¼Œä¹Ÿæœ‰äººæœƒé€ è¬ æ’’è¬Šï¼Œèª˜æƒ‘é–€å¾’å»è·Ÿå¾ä»–å€‘ã€‚æ‰€ä»¥ï¼Œä½ å€‘è¦è­¦é†’ï¼Œè¦è¨˜å¾—é€™ä¸‰å¹´ä»¥ä¾†ï¼Œæˆ‘æ€æ¨£æ—¥å¤œç”¨çœ¼æ·šå‹¸èª¡ã€æ•™å°ä½ å€‘æ¯ä¸€å€‹äººã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 21:10-14", text: "æˆ‘å€‘åœ¨é‚£è£¡ä½äº†å¹¾å¤©å¾Œï¼Œæœ‰ä¸€å€‹å…ˆçŸ¥åå«äºè¿¦å¸ƒï¼Œå¾çŒ¶å¤ªä¾†ã€‚ä»–ä¾†çœ‹æˆ‘å€‘ï¼Œæ‹¿èµ·ä¿ç¾…çš„è…°å¸¶ï¼ŒæŠŠè‡ªå·±çš„æ‰‹è…³ç¶äº†èµ·ä¾†ï¼Œèªªï¼šã€Œè–éˆé€™éº¼èªªï¼šé€™è…°å¸¶çš„ä¸»äººæœƒåœ¨è€¶è·¯æ’’å†·å—çŒ¶å¤ªäººé€™æ¨£çš„æ†ç¶ï¼Œç„¶å¾Œè¢«äº¤çµ¦å¤–é‚¦äººã€‚ã€æˆ‘å€‘ä¸€è½è¦‹é€™è©±å°±è·Ÿç•¶åœ°çš„äººä¸€èµ·æ‡‡åˆ‡åœ°å‹¸å‘Šä¿ç¾…ä¸è¦ä¸Šè€¶è·¯æ’’å†·å»ã€‚å¯æ˜¯ï¼Œä»–èªªï¼šã€Œä½ å€‘ç‚ºä»€éº¼é€™æ¨£ç—›å“­ï¼Œä½¿æˆ‘å¿ƒç¢å‘¢ï¼Ÿæˆ‘ç‚ºè‘—ä¸»è€¶ç©Œçš„ç·£æ•…ï¼Œä¸ä½†åœ¨è€¶è·¯æ’’å†·è¢«æ†ç¶ï¼Œå°±æ˜¯æ­»åœ¨é‚£è£¡ä¹Ÿæ˜¯å¿ƒç”˜æƒ…é¡˜çš„ã€‚ã€æˆ‘å€‘ç„¡æ³•èªªæœä»–ï¼Œå°±éƒ½ä½å£ï¼Œåªèªªï¼šã€Œé¡˜ä¸»çš„æ—¨æ„æˆå°±ã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 22:6-8", text: "ã€Œç•¶æˆ‘è¶•è·¯å¿«åˆ°å¤§é¦¬å£«é©çš„æ™‚å€™ï¼Œç´„åœ¨ä¸­åˆï¼Œå¿½ç„¶æœ‰ä¸€é“å¼·çƒˆçš„å…‰å¾å¤©ç©ºç…§å°„åœ¨æˆ‘çš„å‘¨åœã€‚æˆ‘ä»†å€’åœ¨åœ°ä¸Šï¼Œè½è¦‹æœ‰è²éŸ³å°æˆ‘èªªï¼šã€æƒç¾…ï¼Œæƒç¾…ï¼ä½ ç‚ºä»€éº¼è¿«å®³æˆ‘ï¼Ÿã€æˆ‘å°±å•ï¼šã€ä¸»å•Šï¼Œä½ æ˜¯èª°ï¼Ÿã€ä»–èªªï¼šã€æˆ‘æ˜¯ä½ æ‰€è¿«å®³çš„æ‹¿æ’’å‹’äººè€¶ç©Œã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 22:9-11", text: "é‚£äº›è·Ÿæˆ‘åŒè¡Œçš„äººçœ‹è¦‹äº†é‚£å…‰ï¼Œä½†æ²’æœ‰è½è¦‹é‚£å‘æˆ‘èªªè©±çš„è²éŸ³ã€‚æˆ‘åˆå•ï¼šã€ä¸»å•Šï¼Œæˆ‘è©²åšä»€éº¼ï¼Ÿã€ä¸»å°æˆ‘èªªï¼šã€èµ·ä¾†ï¼Œé€²å¤§é¦¬å£«é©åŸå»ï¼Œåœ¨é‚£è£¡æœ‰äººæœƒå‘Šè¨´ä½ ä¸Šå¸è¦ä½ åšçš„ä¸€åˆ‡äº‹ã€‚ã€ç”±æ–¼é‚£å¼·çƒˆçš„å…‰ï¼Œæˆ‘çš„çœ¼ç›ä¸èƒ½çœ‹è¦‹ï¼Œè·Ÿæˆ‘åŒè¡Œçš„äººå°±ç‰½è‘—æˆ‘çš„æ‰‹ï¼Œå¸¶æˆ‘é€²å¤§é¦¬å£«é©ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 23:6-8", text: "ä¿ç¾…çœ‹å‡ºé€™ä¸€ç¾¤äººç•¶ä¸­æœ‰äº›æ˜¯æ’’éƒ½è©²é»¨çš„äººï¼Œå¦æœ‰äº›æ˜¯æ³•åˆ©è³½æ´¾çš„äººï¼›æ–¼æ˜¯ä»–åœ¨è­°æœƒè£¡é«˜è²èªªï¼šã€ŒåŒèƒå€‘ï¼Œæˆ‘æ˜¯ä¸€å€‹æ³•åˆ©è³½äººï¼Œæ˜¯æ³•åˆ©è³½äººçš„å…’å­ã€‚æˆ‘ä»Šå¤©åœ¨é€™è£¡å—å¯©å•æ˜¯å› ç‚ºæˆ‘ç›¼æœ›æ­»äººå¾©æ´»ï¼ã€ä»–é€™è©±ä¸€å‡ºå£ï¼Œæ³•åˆ©è³½äººå’Œæ’’éƒ½è©²äººå°±çˆ­åµèµ·ä¾†ï¼Œæœƒçœ¾ä¹Ÿåˆ†æˆå…©æ´¾ã€‚å› ç‚ºæ’’éƒ½è©²äººä¸ç›¸ä¿¡å¾©æ´»ï¼Œä¹Ÿä¸ä¿¡æœ‰å¤©ä½¿å’Œç¥éˆï¼Œä½†æ˜¯æ³•åˆ©è³½äººä¸‰æ¨£éƒ½ä¿¡ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 26:22-23", text: "å¯æ˜¯ï¼Œç›´åˆ°ä»Šå¤©ï¼Œæˆ‘è’™ä¸Šå¸å¹«åŠ©ï¼Œèƒ½å¤ ç«™åœ¨é€™è£¡ï¼Œå‘æ‰€æœ‰é«˜è²´å’Œä½å¾®çš„äººä½œè¦‹è­‰ã€‚æˆ‘æ‰€èªªçš„ä¹Ÿå°±æ˜¯å…ˆçŸ¥å’Œæ‘©è¥¿æ‰€èªªå°‡è¦ç™¼ç”Ÿçš„äº‹ï¼Œå°±æ˜¯åŸºç£å¿…é ˆå—å®³ï¼Œä¸¦ä¸”é¦–å…ˆå¾æ­»è£¡å¾©æ´»ï¼Œå‘çŒ¶å¤ªäººå’Œå¤–é‚¦äººå®£å¸ƒæ‹¯æ•‘çš„äº®å…‰å·²ç¶“è‡¨åˆ°ã€‚ã€" },
            { ref: "ä½¿å¾’è¡Œå‚³ 27:23-25", text: "æ˜¨å¤œï¼Œæˆ‘æ‰€å±¬ã€æ‰€æ•¬æ‹œçš„ä¸Šå¸å·®ä»–çš„å¤©ä½¿å°æˆ‘èªªï¼šã€ä¿ç¾…ï¼Œä¸è¦å®³æ€•ï¼ä½ å¿…é ˆç«™åœ¨çš‡å¸é¢å‰ã€‚è€Œä¸”ï¼Œç”±æ–¼ä¸Šå¸çš„æ…ˆæ„›ï¼Œä»–å·²ç¶“å®šæ„ä¿å®ˆæ‰€æœ‰è·Ÿä½ åŒèˆ¹çš„äººçš„æ€§å‘½ã€‚ã€æ‰€ä»¥ï¼Œå„ä½å¯ä»¥æ”¾å¿ƒï¼›æˆ‘ç›¸ä¿¡ä¸Šå¸å¿…å®šå¯¦ç¾ä»–å°æˆ‘èªªçš„è©±ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 28:7-10", text: "è·é›¢é‚£åœ°æ–¹ä¸é ï¼Œé…‹é•·éƒ¨ç™¾æµæœ‰ä¸€ç‰‡ç”°ç”¢ã€‚ä»–æ­¡è¿æˆ‘å€‘ï¼Œèª æ„æ¬¾å¾…æˆ‘å€‘ä¸‰å¤©ã€‚ç•¶æ™‚ï¼Œéƒ¨ç™¾æµçš„çˆ¶è¦ªæ‚£ç†±ç—…å’Œç—¢ç–¾ï¼Œèººåœ¨åºŠä¸Šï¼Œä¿ç¾…åˆ°ä»–çš„è‡¥å®¤å»ï¼Œç‚ºä»–ç¦±å‘Šï¼ŒæŒ‰æ‰‹ï¼Œæ²»å¥½äº†ä»–ã€‚é€™ä¸€ä¾†ï¼Œå³¶ä¸Šæ‰€æœ‰çš„ç—…äººéƒ½ä¾†äº†ï¼Œä¹Ÿéƒ½å¾—åˆ°é†«æ²»ã€‚ä»–å€‘é€çµ¦æˆ‘å€‘è¨±å¤šç¦®ç‰©ï¼›é–‹èˆ¹çš„æ™‚å€™åˆæŠŠæˆ‘å€‘é€”ä¸­æ‰€éœ€è¦çš„æ±è¥¿é€åˆ°èˆ¹ä¸Šã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 28:26-27", text: "ä»¥è³½äºèªªï¼šä½ å»å‘Šè¨´é€™äººæ°‘ï¼šä½ å€‘è½äº†åˆè½ï¼Œå»ä¸æ˜ç™½ï¼Œçœ‹äº†åˆçœ‹ï¼Œå»çœ‹ä¸è¦‹ã€‚å› ç‚ºé€™äººæ°‘å¿ƒæ™ºé–‰å¡ï¼›ä»–å€‘å¡ä½äº†è€³æœµï¼Œé–‰ä¸Šäº†çœ¼ç›ã€‚ä¸ç„¶ï¼Œä»–å€‘çš„çœ¼ç›å°±æœƒçœ‹è¦‹ï¼Œè€³æœµä¹Ÿæœƒè½è¦‹ï¼Œå¿ƒè£¡é ˜æ‚Ÿï¼Œå›å¿ƒè½‰æ„ï¼Œæˆ‘å°±æ²»å¥½ä»–å€‘ã€‚" },
            { ref: "ä½¿å¾’è¡Œå‚³ 28:30-31", text: "ä¿ç¾…åœ¨è‡ªå·±æ‰€ç§Ÿçš„æˆ¿å­ä½äº†å…©å¹´ã€‚å‡¡ä¾†è¨ªå•çš„äººï¼Œä»–éƒ½æ¥å¾…ã€‚ä»–å¤§è†½åœ°å®£æšä¸Šå¸åœ‹çš„ä¿¡æ¯ï¼Œæ•™å°æœ‰é—œä¸»è€¶ç©ŒåŸºç£çš„äº‹ï¼Œæ²’æœ‰å—åˆ°ä»€éº¼é˜»ç¤™ã€‚" }
        ];

        // State variables
        let isReading = false;
        let readingQueue = [];
        let currentQueueIndex = 0;
        let synthesis = window.speechSynthesis;
        let currentUtterance = null;
        let voices = [];

        // Preload voices
        function loadVoices() {
            voices = synthesis.getVoices();
        }

        // Initialize voices on load (handling async nature)
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }
        loadVoices();

        // Initialize UI
        function renderList() {
            const listContainer = document.getElementById('verseList');
            listContainer.innerHTML = bibleVerses.map((verse, index) => `
                <div id="verse-${index}" class="verse-item bg-white p-4 rounded-lg shadow-sm border border-gray-100 flex items-start gap-3 cursor-pointer hover:bg-gray-50" onclick="toggleCheck(${index})">
                    <div class="pt-1">
                        <input type="checkbox" id="check-${index}" value="${index}" class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500 cursor-pointer" onclick="event.stopPropagation()">
                    </div>
                    <div class="flex-1">
                        <div class="font-bold text-blue-800 text-sm mb-1 ref-text">${verse.ref}</div>
                        <div class="verse-text text-gray-800 text-lg">${verse.text}</div>
                    </div>
                </div>
            `).join('');
            
            // Check all by default
            selectAll(true);
        }

        function toggleCheck(index) {
            const checkbox = document.getElementById(`check-${index}`);
            checkbox.checked = !checkbox.checked;
        }

        function selectAll(checked) {
            const checkboxes = document.querySelectorAll('input[type="checkbox"][id^="check-"]');
            checkboxes.forEach(cb => cb.checked = checked);
        }

        function updateRateLabel(val) {
            document.getElementById('rateLabel').textContent = parseFloat(val).toFixed(1);
        }

        // Logic: Reading Control
        function startReading() {
            if (isReading) return; // Already reading

            // Gather selected verses
            const checkboxes = document.querySelectorAll('input[type="checkbox"][id^="check-"]:checked');
            readingQueue = Array.from(checkboxes).map(cb => parseInt(cb.value)).sort((a, b) => a - b);

            if (readingQueue.length === 0) {
                alert("è«‹è‡³å°‘å‹¾é¸ä¸€å€‹ç« ç¯€ï¼");
                return;
            }

            isReading = true;
            currentQueueIndex = 0;
            updatePlayButton(true);
            readNext();
        }

        function stopReading() {
            isReading = false;
            synthesis.cancel();
            updatePlayButton(false);
            clearHighlights();
            document.getElementById('statusText').textContent = "å·²åœæ­¢";
        }

        function updatePlayButton(reading) {
            const btn = document.getElementById('playBtn');
            if (reading) {
                // Pause icon
                btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`;
                btn.onclick = stopReading; // Toggle to stop/pause
                btn.classList.replace('bg-blue-600', 'bg-red-500');
                btn.classList.replace('hover:bg-blue-700', 'hover:bg-red-600');
            } else {
                // Play icon
                btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`;
                btn.onclick = startReading;
                btn.classList.replace('bg-red-500', 'bg-blue-600');
                btn.classList.replace('hover:bg-red-600', 'hover:bg-blue-700');
            }
        }

        function readNext() {
            if (!isReading) return;

            // Check if queue finished
            if (currentQueueIndex >= readingQueue.length) {
                const loop = document.getElementById('loopToggle').checked;
                if (loop) {
                    currentQueueIndex = 0; // Restart
                } else {
                    stopReading();
                    document.getElementById('statusText').textContent = "æ’­æ”¾å®Œç•¢";
                    return;
                }
            }

            const verseIndex = readingQueue[currentQueueIndex];
            const verse = bibleVerses[verseIndex];

            // Highlight UI
            highlightVerse(verseIndex);
            
            // Prepare Speech
            // We transform the text specifically for TTS to fix pronunciation
            let spokenRef = verse.ref;
            
            // 1. Force "zhuan4" sound for "å‚³" by using "æ’°" (compose)
            spokenRef = spokenRef.replace(/ä½¿å¾’è¡Œå‚³/g, "ä½¿å¾’è¡Œæ’°");
            
            // 2. Read ":" as "ç« "
            spokenRef = spokenRef.replace(/:/g, "ç« ");
            
            // 3. Read "-" as "è‡³" (for ranges like 34-35)
            spokenRef = spokenRef.replace(/-/g, "è‡³");
            
            // 4. Append "ç¯€" at the end for natural reading
            spokenRef = spokenRef + "ç¯€";

            const textToRead = `${spokenRef}ã€‚${verse.text}`;
            const utterance = new SpeechSynthesisUtterance(textToRead);
            
            // Settings
            utterance.rate = parseFloat(document.getElementById('rate').value);
            utterance.lang = 'zh-TW'; // Force Traditional Chinese
            
            // Try to assign a voice if available
            if (voices.length > 0) {
                const voice = voices.find(v => v.lang.includes('zh-TW')) || voices.find(v => v.lang.includes('zh'));
                if (voice) {
                    utterance.voice = voice;
                }
            }
            
            // Events
            utterance.onend = () => {
                if (isReading) {
                    currentQueueIndex++;
                    // Small delay between verses for better flow
                    setTimeout(readNext, 800); 
                }
            };

            utterance.onerror = (e) => {
                // Ignore 'canceled' and 'interrupted' errors as they are expected when stopping or switching
                if (e.error === 'canceled' || e.error === 'interrupted') {
                    return; 
                }
                
                console.error('Speech error:', e);
                // Try to skip to next on error only if it's a real error and we are still in reading mode
                if (isReading) {
                    currentQueueIndex++;
                    setTimeout(readNext, 500);
                }
            };

            currentUtterance = utterance;
            document.getElementById('statusText').textContent = `æ­£åœ¨æœ—è®€: ${verse.ref}`;
            synthesis.speak(utterance);
        }

        function highlightVerse(index) {
            clearHighlights();
            const el = document.getElementById(`verse-${index}`);
            if (el) {
                el.classList.add('active');
                // Smooth scroll into view
                el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function clearHighlights() {
            document.querySelectorAll('.verse-item').forEach(el => el.classList.remove('active'));
        }

        // Handle page unload to stop speech
        window.onbeforeunload = () => {
            synthesis.cancel();
        };

        // Initial Render
        renderList();

    </script>
</body>
</html>